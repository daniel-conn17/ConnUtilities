gene_list <- c("Gata2", "Socs2", "Irf8")
pca_gene_dat <- form_ggdat(gene_list, generic_names = F,
kmeans_obj=kmeans_obj[[best_kmeans_obj_ind]])
pca_gene_dat <- data.frame(pca_gene_dat, pca_coordinates)
pca_gene_plots <- vector("list", length=3)
pca_gene_plot <- function(dat, pca_gene_name, pca_gene_facet){
facet_var <- enquo(pca_gene_facet)
gene_quo <- enquo(pca_gene_name)
pca_gene <- ggplot(dat, aes(Dim.1, Dim.2,
color=!!gene_quo)) +
geom_point(alpha=.5) + ggpubr::theme_pubr()
if(!missing(facet)){
pca_gene <- pca_gene + facet_grid(cols = vars(!!facet_var))
}
pca_gene
}
ptest <- pca_gene_plot(pca_gene_dat, Gata2, facet=Treatment)
ptest
gene_list <- c("Gata2", "Socs2", "Irf8")
pca_gene_dat <- form_ggdat(gene_list, generic_names = F,
kmeans_obj=kmeans_obj[[best_kmeans_obj_ind]])
pca_gene_dat <- data.frame(pca_gene_dat, pca_coordinates)
pca_gene_plots <- vector("list", length=3)
pca_gene_plot <- function(dat, pca_gene_name, pca_gene_facet){
facet_var <- enquo(pca_gene_facet)
gene_quo <- enquo(pca_gene_name)
pca_gene <- ggplot(dat, aes(Dim.1, Dim.2,
color=!!gene_quo)) +
geom_point(alpha=.5) + ggpubr::theme_pubr()
if(!missing(facet)){
pca_gene <- pca_gene + facet_grid(cols = vars(!!facet_var))
}
pca_gene
}
ptest <- pca_gene_plot(pca_gene_dat, Gata2, pca_gene_facet=Treatment)
gene_list <- c("Gata2", "Socs2", "Irf8")
pca_gene_dat <- form_ggdat(gene_list, generic_names = F,
kmeans_obj=kmeans_obj[[best_kmeans_obj_ind]])
pca_gene_dat <- data.frame(pca_gene_dat, pca_coordinates)
pca_gene_plots <- vector("list", length=3)
pca_gene_plot <- function(dat, pca_gene_name, pca_gene_facet){
facet_var <- enquo(pca_gene_facet)
gene_quo <- enquo(pca_gene_name)
pca_gene <- ggplot(dat, aes(Dim.1, Dim.2,
color=!!gene_quo)) +
geom_point(alpha=.5) + ggpubr::theme_pubr()
if(!missing(pca_gene_facet)){
pca_gene <- pca_gene + facet_grid(cols = vars(!!facet_var))
}
pca_gene
}
ptest <- pca_gene_plot(pca_gene_dat, Gata2, pca_gene_facet=Treatment)
ptest
ll <- function(...){args <- list(...); length(args)}
ll(1, 1, 1)
ll()
gene_list <- c("Gata2", "Socs2", "Irf8")
pca_gene_dat <- form_ggdat(gene_list, generic_names = F,
kmeans_obj=kmeans_obj[[best_kmeans_obj_ind]])
gene_list <- c("Gata2", "Socs2", "Irf8")
pca_gene_dat <- form_ggdat(gene_list, generic_names = F,
kmeans_obj=kmeans_obj[[best_kmeans_obj_ind]])
pca_gene_dat <- data.frame(pca_gene_dat, pca_coordinates)
pca_gene_plots <- vector("list", length=3)
pca_gene_plot <- function(dat, pca_gene_name, ...){
gene_quo <- enquo(pca_gene_name)
pca_gene <- ggplot(dat, aes(Dim.1, Dim.2,
color=!!gene_quo)) +
geom_point(alpha=.5) + ggpubr::theme_pubr()
facet_vars <- list(...)
if(length(facet_vars) > 0){
pca_gene <- pca_gene + facet_wrap(cols = vars(...))
}
pca_gene
}
ptest <- pca_gene_plot(pca_gene_dat, Gata2, Treatment)
gene_list <- c("Gata2", "Socs2", "Irf8")
pca_gene_dat <- form_ggdat(gene_list, generic_names = F,
kmeans_obj=kmeans_obj[[best_kmeans_obj_ind]])
pca_gene_dat <- data.frame(pca_gene_dat, pca_coordinates)
pca_gene_plots <- vector("list", length=3)
hh(pca_gene_dat)
gene_list <- c("Gata2", "Socs2", "Irf8")
pca_gene_dat <- form_ggdat(gene_list, generic_names = F,
kmeans_obj=kmeans_obj[[best_kmeans_obj_ind]])
pca_gene_dat <- data.frame(pca_gene_dat, pca_coordinates)
pca_gene_plots <- vector("list", length=3)
pca_gene_plot <- function(dat, pca_gene_name, ...){
gene_quo <- enquo(pca_gene_name)
pca_gene <- ggplot(dat, aes(Dim.1, Dim.2,
color=!!gene_quo)) +
geom_point(alpha=.5) + ggpubr::theme_pubr()
pca_gene <- pca_gene + facet_wrap(cols = vars(...))
pca_gene
}
ptest <- pca_gene_plot(pca_gene_dat, Gata2, Treatment)
gene_list <- c("Gata2", "Socs2", "Irf8")
pca_gene_dat <- form_ggdat(gene_list, generic_names = F,
kmeans_obj=kmeans_obj[[best_kmeans_obj_ind]])
pca_gene_dat <- data.frame(pca_gene_dat, pca_coordinates)
pca_gene_plots <- vector("list", length=3)
pca_gene_plot <- function(dat, pca_gene_name, ...){
gene_quo <- enquo(pca_gene_name)
pca_gene <- ggplot(dat, aes(Dim.1, Dim.2,
color=!!gene_quo)) +
geom_point(alpha=.5) + ggpubr::theme_pubr()
pca_gene <- pca_gene + facet_wrap(vars(...))
pca_gene
}
ptest <- pca_gene_plot(pca_gene_dat, Gata2, Treatment)
ptest
gene_list <- c("Gata2", "Socs2", "Irf8")
pca_gene_dat <- form_ggdat(gene_list, generic_names = F,
kmeans_obj=kmeans_obj[[best_kmeans_obj_ind]])
pca_gene_dat <- data.frame(pca_gene_dat, pca_coordinates)
pca_gene_plots <- vector("list", length=3)
pca_gene_plot <- function(dat, pca_gene_name, ...){
gene_quo <- enquo(pca_gene_name)
pca_gene <- ggplot(dat, aes(Dim.1, Dim.2,
color=!!gene_quo)) +
geom_point(alpha=.5) + ggpubr::theme_pubr()
pca_gene <- pca_gene + facet_wrap(vars(...))
pca_gene
}
ptest <- pca_gene_plot(pca_gene_dat, Gata2)
ptest
pca_gene_dat[[i]] <-
df <- data.frame(y=1, var=2)
df$y
df$var
ll <- data.frame(x=rnorm(n), y=rnorm(n), z=rnorm(n))
test_fun <- function(dat, x, y){
p <- ggplot(dat, aes(!!x, !!y)) + geom_point()
}
ll <- data.frame(x=rnorm(n), y=rnorm(n), z=rnorm(n))
test_fun <- function(dat, x, y){
p <- ggplot(dat, aes(!!x, !!y)) + geom_point()
}
ll <- data.frame(x=rnorm(n), y=rnorm(n), z=rnorm(n))
n <- 1000
n <- 1000
ll <- data.frame(x=rnorm(n), y=rnorm(n), z=rnorm(n))
test_fun <- function(dat, x, y){
p <- ggplot(dat, aes(!!x, !!y)) + geom_point()
}
test_fun(ll, "x", "y")
n <- 1000
ll <- data.frame(x=rnorm(n), y=rnorm(n), z=rnorm(n))
test_fun <- function(dat, x, y){
p <- ggplot(dat, aes(!!x, !!y)) + geom_point()
}
ptest <- test_fun(ll, "x", "y")
ptest
hh(ll)
n <- 1000
ll <- data.frame(x=rnorm(n), y=rnorm(n), z=rnorm(n))
test_fun <- function(dat, x, y){
p <- ggplot(dat, aes(!!x, !!y)) + geom_point()
}
ptest <- test_fun(ll, x="x", y="y")
n <- 1000
ll <- data.frame(x=rnorm(n), y=rnorm(n), z=rnorm(n))
test_fun <- function(dat, x, y){
p <- ggplot(dat, aes(!!x, !!y)) + geom_point()
browser()
}
ptest <- test_fun(ll, x="x", y="y")
p
hh(dat)
source('~/.active-rstudio-document', echo=TRUE)
emp_plot_dat <- form_ggdat(c("Gata2", "Socs2", "Irf8"), kmeans_obj[[3]])
names(emp_plot_dat)[1:3] <- c("Gata2", "Socs2", "Irf8")
hh(emp_plot_dat)
ll <- empirical_class_fun(emp_plot_dat, "Socs2", "Gata2", "Treatment")
ll
table(emp_plot_dat$Cluster)
empirical_class_fun <- function(dat, out_name, cov_name, facet_var=NULL){
if(is.null(facet_var)){
cdat <- dat[, c(out_name, cov_name)]
names(cdat) <- c("outcome", "covariate")
}
facet_num <- length(facet_var)
if(!is.null(facet_var)){
facet_names <- paste0("facet", 1:facet_num)
cdat <- dat[, c(out_name, cov_name, facet_var)]
names(cdat) <- c("outcome", "covariate", facet_names)
}
cov_cut <- Hmisc::cut2(cdat$covariate, m=500, levels.mean=T, digits=3)
cdat <- data.frame(cdat, cut=cov_cut)
dat_prop <- dplyr::group_by(cdat, cut, facet1)
dat_prop <- dplyr::summarise(dat_prop, proportion=mean(outcome))
if(is.null(facet_var)){
emp_p <- ggplot(dat_prop, aes(cut, proportion)) + geom_point() +
ggpubr::theme_pubr()
}
if(facet_num==1){
emp_p <- ggplot(dat_prop, aes(cut, proportion)) + geom_point() +
ggpubr::theme_pubr() + facet_wrap(facet1 ~ .)
}
if(facet_num==2){
emp_p <- ggplot(dat_prop, aes(cut, proportion)) + geom_point() +
ggpubr::theme_pubr() + facet_wrap(facet1 ~ facet2)
}
emp_p
}
empirical_class_fun <- function(dat, out_name, cov_name, facet_var=NULL){
if(is.null(facet_var)){
cdat <- dat[, c(out_name, cov_name)]
names(cdat) <- c("outcome", "covariate")
}
facet_num <- length(facet_var)
if(!is.null(facet_var)){
facet_names <- paste0("facet", 1:facet_num)
cdat <- dat[, c(out_name, cov_name, facet_var)]
names(cdat) <- c("outcome", "covariate", facet_names)
}
cov_cut <- Hmisc::cut2(cdat$covariate, m=500, levels.mean=T, digits=3)
cdat <- data.frame(cdat, cut=cov_cut)
dat_prop <- dplyr::group_by(cdat, cut, facet1)
dat_prop <- dplyr::summarise(dat_prop, proportion=mean(outcome))
if(is.null(facet_var)){
emp_p <- ggplot(dat_prop, aes(cut, proportion)) + geom_point() +
ggpubr::theme_pubr()
}
if(facet_num==1){
emp_p <- ggplot(dat_prop, aes(cut, proportion)) + geom_point() +
ggpubr::theme_pubr() + facet_wrap(facet1 ~ .)
}
if(facet_num==2){
emp_p <- ggplot(dat_prop, aes(cut, proportion)) + geom_point() +
ggpubr::theme_pubr() + facet_wrap(facet1 ~ facet2)
}
emp_p
}
emp_plot_dat <- form_ggdat(c("Gata2", "Socs2", "Irf8"), kmeans_obj[[3]])
names(emp_plot_dat)[1:3] <- c("Gata2", "Socs2", "Irf8")
ll <- empirical_class_fun(emp_plot_dat, "Socs2", "Gata2",
c("Treatment", "Cluster"))
ll
empirical_class_fun <- function(dat, out_name, cov_name, facet_var=NULL){
if(is.null(facet_var)){
cdat <- dat[, c(out_name, cov_name)]
names(cdat) <- c("outcome", "covariate")
}
facet_num <- length(facet_var)
if(!is.null(facet_var)){
facet_names <- paste0("facet", 1:facet_num)
cdat <- dat[, c(out_name, cov_name, facet_var)]
names(cdat) <- c("outcome", "covariate", facet_names)
}
cov_cut <- Hmisc::cut2(cdat$covariate, m=500, levels.mean=T, digits=3)
cdat <- data.frame(cdat, cut=cov_cut)
if(is.null(facet_var)){
dat_prop <- dplyr::group_by(cdat, cut)
dat_prop <- dplyr::summarise(dat_prop, proportion=mean(outcome))
emp_p <- ggplot(dat_prop, aes(cut, proportion)) + geom_point() +
ggpubr::theme_pubr()
}
if(facet_num==1){
dat_prop <- dplyr::group_by(cdat, cut, facet1)
dat_prop <- dplyr::summarise(dat_prop, proportion=mean(outcome))
emp_p <- ggplot(dat_prop, aes(cut, proportion)) + geom_point() +
ggpubr::theme_pubr() + facet_wrap(facet1 ~ .)
}
if(facet_num==2){
dat_prop <- dplyr::group_by(cdat, cut, facet1, facet2)
dat_prop <- dplyr::summarise(dat_prop, proportion=mean(outcome))
emp_p <- ggplot(dat_prop, aes(cut, proportion)) + geom_point() +
ggpubr::theme_pubr() + facet_wrap(facet1 ~ facet2)
}
emp_p
}
emp_plot_dat <- form_ggdat(c("Gata2", "Socs2", "Irf8"), kmeans_obj[[3]])
names(emp_plot_dat)[1:3] <- c("Gata2", "Socs2", "Irf8")
ll <- empirical_class_fun(emp_plot_dat, "Socs2", "Gata2",
c("Treatment", "Cluster"))
ll
empirical_class_fun <- function(dat, out_name, cov_name, facet_var=NULL){
if(is.null(facet_var)){
cdat <- dat[, c(out_name, cov_name)]
names(cdat) <- c("outcome", "covariate")
}
facet_num <- length(facet_var)
if(!is.null(facet_var)){
facet_names <- paste0("facet", 1:facet_num)
cdat <- dat[, c(out_name, cov_name, facet_var)]
names(cdat) <- c("outcome", "covariate", facet_names)
}
cov_cut <- Hmisc::cut2(cdat$covariate, m=500, levels.mean=T, digits=3)
cdat <- data.frame(cdat, cut=cov_cut)
if(is.null(facet_var)){
dat_prop <- dplyr::group_by(cdat, cut)
dat_prop <- dplyr::summarise(dat_prop, proportion=mean(outcome))
emp_p <- ggplot(dat_prop, aes(cut, proportion)) + geom_point() +
ggpubr::theme_pubr()
}
if(facet_num==1){
dat_prop <- dplyr::group_by(cdat, cut, facet1)
dat_prop <- dplyr::summarise(dat_prop, proportion=mean(outcome))
emp_p <- ggplot(dat_prop, aes(cut, proportion)) + geom_point() +
ggpubr::theme_pubr() + facet_wrap(facet1 ~ .)
}
if(facet_num==2){
dat_prop <- dplyr::group_by(cdat, cut, facet1, facet2)
dat_prop <- dplyr::summarise(dat_prop, proportion=mean(outcome))
emp_p <- ggplot(dat_prop, aes(cut, proportion)) + geom_point() +
ggpubr::theme_pubr() + facet_wrap(facet1 ~ facet2)
}
ctitle <- sprintf("Empirical probability of %s expression as a function of Gata2", out_name)
emp_p <- emp_p + labs(x="Quantile group",
y="Proportion of cells in which gene is unexpressed",
title=ctitle)
}
emp_plot_dat <- form_ggdat(c("Gata2", "Socs2", "Irf8"), kmeans_obj[[3]])
names(emp_plot_dat)[1:3] <- c("Gata2", "Socs2", "Irf8")
ll <- empirical_class_fun(emp_plot_dat, "Socs2", "Gata2",
c("Treatment", "Cluster"))
ll
?aes
kdjk
exprs(kdjk)
kdjk <- 1
?expr
expr(kdjk)
rlang::sym(kdjk)
rlang::sym("kdjk")
rm(kdjk)
rlang::sym("kdjk")
source('~/.active-rstudio-document', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
all_hl_plots[[1]]
empirical_class_fun <- function(dat, out_name, cov_name, facet_var=NULL){
if(is.null(facet_var)){
cdat <- dat[, c(out_name, cov_name)]
names(cdat) <- c("outcome", "covariate")
}
facet_num <- length(facet_var)
if(!is.null(facet_var)){
facet_names <- paste0("facet", 1:facet_num)
cdat <- dat[, c(out_name, cov_name, facet_var)]
names(cdat) <- c("outcome", "covariate", facet_names)
}
cdat$outcome <- as.numeric(cdat$outcome != 1)
cov_cut <- Hmisc::cut2(cdat$covariate, m=500, levels.mean=T, digits=3)
cdat <- data.frame(cdat, cut=cov_cut)
if(is.null(facet_var)){
dat_prop <- dplyr::group_by(cdat, cut)
dat_prop <- dplyr::summarise(dat_prop, proportion=mean(outcome))
emp_p <- ggplot(dat_prop, aes(cut, proportion)) + geom_point() +
ggpubr::theme_pubr()
}
if(facet_num==1){
dat_prop <- dplyr::group_by(cdat, cut, facet1)
dat_prop <- dplyr::summarise(dat_prop, proportion=mean(outcome))
emp_p <- ggplot(dat_prop, aes(cut, proportion)) + geom_point() +
ggpubr::theme_pubr() + facet_wrap(facet1 ~ .)
}
if(facet_num==2){
dat_prop <- dplyr::group_by(cdat, cut, facet1, facet2)
dat_prop <- dplyr::summarise(dat_prop, proportion=mean(outcome))
emp_p <- ggplot(dat_prop, aes(cut, proportion)) + geom_point() +
ggpubr::theme_pubr() + facet_wrap(facet1 ~ facet2)
}
ctitle <- sprintf("Empirical probability of %s expression as a function of Gata2", out_name)
emp_p <- emp_p + labs(x="Quantile group",
y="Proportion of cells in which gene is expressed",
title=ctitle)
}
emp_plot_dat <- form_ggdat(c("Gata2", "Socs2", "Irf8"), kmeans_obj[[3]])
names(emp_plot_dat)[1:3] <- c("Gata2", "Socs2", "Irf8")
all_hl_plots <- vector("list", length=4)
all_hl_plots[[1]] <- empirical_class_fun(emp_plot_dat, "Socs2", "Gata2",
c("Treatment"))
all_hl_plots[[1]]
empirical_class_fun <- function(dat, out_name, cov_name, facet_var=NULL){
if(is.null(facet_var)){
cdat <- dat[, c(out_name, cov_name)]
names(cdat) <- c("outcome", "covariate")
}
facet_num <- length(facet_var)
if(!is.null(facet_var)){
facet_names <- paste0("facet", 1:facet_num)
cdat <- dat[, c(out_name, cov_name, facet_var)]
names(cdat) <- c("outcome", "covariate", facet_names)
}
cdat$outcome <- as.numeric(cdat$outcome != 0)
cov_cut <- Hmisc::cut2(cdat$covariate, m=500, levels.mean=T, digits=3)
cdat <- data.frame(cdat, cut=cov_cut)
if(is.null(facet_var)){
dat_prop <- dplyr::group_by(cdat, cut)
dat_prop <- dplyr::summarise(dat_prop, proportion=mean(outcome))
emp_p <- ggplot(dat_prop, aes(cut, proportion)) + geom_point() +
ggpubr::theme_pubr()
}
if(facet_num==1){
dat_prop <- dplyr::group_by(cdat, cut, facet1)
dat_prop <- dplyr::summarise(dat_prop, proportion=mean(outcome))
emp_p <- ggplot(dat_prop, aes(cut, proportion)) + geom_point() +
ggpubr::theme_pubr() + facet_wrap(facet1 ~ .)
}
if(facet_num==2){
dat_prop <- dplyr::group_by(cdat, cut, facet1, facet2)
dat_prop <- dplyr::summarise(dat_prop, proportion=mean(outcome))
emp_p <- ggplot(dat_prop, aes(cut, proportion)) + geom_point() +
ggpubr::theme_pubr() + facet_wrap(facet1 ~ facet2)
}
ctitle <- sprintf("Empirical probability of %s expression as a function of Gata2", out_name)
emp_p <- emp_p + labs(x="Quantile group",
y="Proportion of cells in which gene is expressed",
title=ctitle)
}
emp_plot_dat <- form_ggdat(c("Gata2", "Socs2", "Irf8"), kmeans_obj[[3]])
names(emp_plot_dat)[1:3] <- c("Gata2", "Socs2", "Irf8")
all_hl_plots <- vector("list", length=4)
all_hl_plots[[1]] <- empirical_class_fun(emp_plot_dat, "Socs2", "Gata2",
c("Treatment"))
all_hl_plots[[1]]
empirical_class_fun <- function(dat, out_name, cov_name, facet_var=NULL){
if(is.null(facet_var)){
cdat <- dat[, c(out_name, cov_name)]
names(cdat) <- c("outcome", "covariate")
}
facet_num <- length(facet_var)
if(!is.null(facet_var)){
facet_names <- paste0("facet", 1:facet_num)
cdat <- dat[, c(out_name, cov_name, facet_var)]
names(cdat) <- c("outcome", "covariate", facet_names)
}
browser()
cdat$outcome <- as.numeric(cdat$outcome != 0)
cov_cut <- Hmisc::cut2(cdat$covariate, m=500, levels.mean=T, digits=3)
cdat <- data.frame(cdat, cut=cov_cut)
if(is.null(facet_var)){
dat_prop <- dplyr::group_by(cdat, cut)
dat_prop <- dplyr::summarise(dat_prop, proportion=mean(outcome))
emp_p <- ggplot(dat_prop, aes(cut, proportion)) + geom_point() +
ggpubr::theme_pubr()
}
if(facet_num==1){
dat_prop <- dplyr::group_by(cdat, cut, facet1)
dat_prop <- dplyr::summarise(dat_prop, proportion=mean(outcome))
emp_p <- ggplot(dat_prop, aes(cut, proportion)) + geom_point() +
ggpubr::theme_pubr() + facet_wrap(facet1 ~ .)
}
if(facet_num==2){
dat_prop <- dplyr::group_by(cdat, cut, facet1, facet2)
dat_prop <- dplyr::summarise(dat_prop, proportion=mean(outcome))
emp_p <- ggplot(dat_prop, aes(cut, proportion)) + geom_point() +
ggpubr::theme_pubr() + facet_wrap(facet1 ~ facet2)
}
ctitle <- sprintf("Empirical probability of %s expression as a function of Gata2", out_name)
emp_p <- emp_p + labs(x="Quantile group",
y="Proportion of cells in which gene is expressed",
title=ctitle)
}
emp_plot_dat <- form_ggdat(c("Gata2", "Socs2", "Irf8"), kmeans_obj[[3]])
names(emp_plot_dat)[1:3] <- c("Gata2", "Socs2", "Irf8")
all_hl_plots <- vector("list", length=4)
all_hl_plots[[1]] <- empirical_class_fun(emp_plot_dat, "Socs2", "Gata2",
c("Treatment"))
hh(cdat$outcome)
hh(as.numeric(cdat$outcome != 0))
empirical_class_fun <- function(dat, out_name, cov_name, facet_var=NULL){
if(is.null(facet_var)){
cdat <- dat[, c(out_name, cov_name)]
names(cdat) <- c("outcome", "covariate")
}
facet_num <- length(facet_var)
if(!is.null(facet_var)){
facet_names <- paste0("facet", 1:facet_num)
cdat <- dat[, c(out_name, cov_name, facet_var)]
names(cdat) <- c("outcome", "covariate", facet_names)
}
cdat$outcome <- as.numeric(cdat$outcome != 0)
cov_cut <- Hmisc::cut2(cdat$covariate, m=250, levels.mean=T, digits=3)
cdat <- data.frame(cdat, cut=cov_cut)
if(is.null(facet_var)){
dat_prop <- dplyr::group_by(cdat, cut)
dat_prop <- dplyr::summarise(dat_prop, proportion=mean(outcome))
emp_p <- ggplot(dat_prop, aes(cut, proportion)) + geom_point() +
ggpubr::theme_pubr()
}
if(facet_num==1){
dat_prop <- dplyr::group_by(cdat, cut, facet1)
dat_prop <- dplyr::summarise(dat_prop, proportion=mean(outcome))
emp_p <- ggplot(dat_prop, aes(cut, proportion)) + geom_point() +
ggpubr::theme_pubr() + facet_wrap(facet1 ~ .)
}
if(facet_num==2){
dat_prop <- dplyr::group_by(cdat, cut, facet1, facet2)
dat_prop <- dplyr::summarise(dat_prop, proportion=mean(outcome))
emp_p <- ggplot(dat_prop, aes(cut, proportion)) + geom_point() +
ggpubr::theme_pubr() + facet_wrap(facet1 ~ facet2)
}
ctitle <- sprintf("Empirical probability of %s expression as a function of Gata2", out_name)
emp_p <- emp_p + labs(x="Quantile group",
y="Proportion of cells in which gene is expressed",
title=ctitle)
}
emp_plot_dat <- form_ggdat(c("Gata2", "Socs2", "Irf8"), kmeans_obj[[3]])
names(emp_plot_dat)[1:3] <- c("Gata2", "Socs2", "Irf8")
all_hl_plots <- vector("list", length=4)
all_hl_plots[[1]] <- empirical_class_fun(emp_plot_dat, "Socs2", "Gata2",
c("Treatment"))
all_hl_plots[[1]]
all_hl_plots[[2]] <- empirical_class_fun(emp_plot_dat, "Irf8", "Gata2",
c("Treatment"))
all_hl_plots[[3]] <- empirical_class_fun(emp_plot_dat, "Socs2", "Gata2",
c("Treatment", "Cluster"))
all_hl_plots[[4]] <- empirical_class_fun(emp_plot_dat, "Socs2", "Gata2",
c("Treatment", "Cluster"))
all_hl_plots[[3]]
